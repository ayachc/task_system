(function(t){function e(e){for(var s,n,c=e[0],l=e[1],i=e[2],u=0,p=[];u<c.length;u++)n=c[u],Object.prototype.hasOwnProperty.call(r,n)&&r[n]&&p.push(r[n][0]),r[n]=0;for(s in l)Object.prototype.hasOwnProperty.call(l,s)&&(t[s]=l[s]);m&&m(e);while(p.length)p.shift()();return o.push.apply(o,i||[]),a()}function a(){for(var t,e=0;e<o.length;e++){for(var a=o[e],s=!0,n=1;n<a.length;n++){var c=a[n];0!==r[c]&&(s=!1)}s&&(o.splice(e--,1),t=l(l.s=a[0]))}return t}var s={},n={app:0},r={app:0},o=[];function c(t){return l.p+"js/"+({}[t]||t)+"."+{"chunk-4c0ee788":"4f794413","chunk-14b4a015":"28a29a40","chunk-187406d0":"2fa674f5","chunk-1bc0dd11":"6bf56c7d","chunk-36686bd0":"53fe1bb0","chunk-7aad115e":"f8c2428d"}[t]+".js"}function l(e){if(s[e])return s[e].exports;var a=s[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,l),a.l=!0,a.exports}l.e=function(t){var e=[],a={"chunk-14b4a015":1,"chunk-187406d0":1,"chunk-1bc0dd11":1,"chunk-36686bd0":1,"chunk-7aad115e":1};n[t]?e.push(n[t]):0!==n[t]&&a[t]&&e.push(n[t]=new Promise((function(e,a){for(var s="css/"+({}[t]||t)+"."+{"chunk-4c0ee788":"31d6cfe0","chunk-14b4a015":"710d9b31","chunk-187406d0":"47014259","chunk-1bc0dd11":"6ec781d4","chunk-36686bd0":"996b60fb","chunk-7aad115e":"7cfd8235"}[t]+".css",r=l.p+s,o=document.getElementsByTagName("link"),c=0;c<o.length;c++){var i=o[c],u=i.getAttribute("data-href")||i.getAttribute("href");if("stylesheet"===i.rel&&(u===s||u===r))return e()}var p=document.getElementsByTagName("style");for(c=0;c<p.length;c++){i=p[c],u=i.getAttribute("data-href");if(u===s||u===r)return e()}var m=document.createElement("link");m.rel="stylesheet",m.type="text/css",m.onload=e,m.onerror=function(e){var s=e&&e.target&&e.target.src||r,o=new Error("Loading CSS chunk "+t+" failed.\n("+s+")");o.code="CSS_CHUNK_LOAD_FAILED",o.request=s,delete n[t],m.parentNode.removeChild(m),a(o)},m.href=r;var g=document.getElementsByTagName("head")[0];g.appendChild(m)})).then((function(){n[t]=0})));var s=r[t];if(0!==s)if(s)e.push(s[2]);else{var o=new Promise((function(e,a){s=r[t]=[e,a]}));e.push(s[2]=o);var i,u=document.createElement("script");u.charset="utf-8",u.timeout=120,l.nc&&u.setAttribute("nonce",l.nc),u.src=c(t);var p=new Error;i=function(e){u.onerror=u.onload=null,clearTimeout(m);var a=r[t];if(0!==a){if(a){var s=e&&("load"===e.type?"missing":e.type),n=e&&e.target&&e.target.src;p.message="Loading chunk "+t+" failed.\n("+s+": "+n+")",p.name="ChunkLoadError",p.type=s,p.request=n,a[1](p)}r[t]=void 0}};var m=setTimeout((function(){i({type:"timeout",target:u})}),12e4);u.onerror=u.onload=i,document.head.appendChild(u)}return Promise.all(e)},l.m=t,l.c=s,l.d=function(t,e,a){l.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},l.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},l.t=function(t,e){if(1&e&&(t=l(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(l.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)l.d(a,s,function(e){return t[e]}.bind(null,s));return a},l.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return l.d(e,"a",e),e},l.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},l.p="/",l.oe=function(t){throw console.error(t),t};var i=window["webpackJsonp"]=window["webpackJsonp"]||[],u=i.push.bind(i);i.push=e,i=i.slice();for(var p=0;p<i.length;p++)e(i[p]);var m=u;o.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},1573:function(t,e,a){},"56d7":function(t,e,a){"use strict";a.r(e);var s=a("2b0e"),n=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"container-fluid"},[e("div",{staticClass:"row"},[e("nav",{staticClass:"col-md-3 col-lg-2 d-md-block bg-light sidebar",attrs:{id:"sidebar"}},[e("div",{staticClass:"sidebar-sticky pt-3"},[t._m(0),e("ul",{staticClass:"nav flex-column"},[e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{to:"/tasks","active-class":"active"}},[e("i",{staticClass:"bi bi-list-task mr-2"}),t._v(" 任务管理 ")])],1),e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{to:"/agents","active-class":"active"}},[e("i",{staticClass:"bi bi-pc-display mr-2"}),t._v(" Agent管理 ")])],1),e("li",{staticClass:"nav-item"},[e("router-link",{staticClass:"nav-link",attrs:{to:"/templates","active-class":"active"}},[e("i",{staticClass:"bi bi-file-earmark-code mr-2"}),t._v(" 脚本模板 ")])],1)]),t._m(1)])]),e("main",{staticClass:"col-md-9 ml-sm-auto col-lg-10 px-md-4",attrs:{role:"main"}},[e("div",{staticClass:"d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"},[e("h1",{staticClass:"h2"},[t._v(t._s(t.currentPageTitle))]),e("div",{staticClass:"btn-toolbar mb-2 mb-md-0"},["/tasks"===t.$route.path?e("div",[e("router-link",{staticClass:"btn btn-sm btn-primary",attrs:{to:"/tasks/new"}},[e("i",{staticClass:"bi bi-plus"}),t._v(" 新建任务 ")])],1):t._e(),"/templates"===t.$route.path?e("div",[e("b-button",{staticClass:"btn btn-sm btn-primary",on:{click:function(e){return t.$root.$emit("show-create-template-modal")}}},[e("i",{staticClass:"bi bi-plus"}),t._v(" 新建模板 ")])],1):t._e()])]),e("router-view")],1)])])])},r=[function(){var t=this,e=t._self._c;return e("h5",{staticClass:"sidebar-heading d-flex justify-content-between align-items-center px-3 mt-4 mb-1 text-muted"},[e("span",[t._v("LLM任务管理系统")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"mt-5 px-3 text-muted small"},[e("div",[t._v("版本: 0.1.0")]),e("div",{staticClass:"mt-2"},[t._v("2025 个人用LLM训练管理系统")])])}],o={name:"App",computed:{currentPageTitle(){const t=this.$route.path;return t.startsWith("/tasks")?"/tasks/new"===t?"新建任务":"任务管理":t.startsWith("/agents")?"Agent管理":t.startsWith("/templates")?"/templates/new"===t?"新建模板":"脚本模板":"首页"}}},c=o,l=(a("6fd6"),a("2877")),i=Object(l["a"])(c,n,r,!1,null,null,null),u=i.exports,p=a("8c4f");const m=()=>Promise.all([a.e("chunk-4c0ee788"),a.e("chunk-36686bd0")]).then(a.bind(null,"f0b3")),g=()=>a.e("chunk-7aad115e").then(a.bind(null,"c68e")),d=()=>Promise.all([a.e("chunk-4c0ee788"),a.e("chunk-187406d0")]).then(a.bind(null,"b480")),T=()=>Promise.all([a.e("chunk-4c0ee788"),a.e("chunk-1bc0dd11")]).then(a.bind(null,"235a")),E=()=>Promise.all([a.e("chunk-4c0ee788"),a.e("chunk-14b4a015")]).then(a.bind(null,"acd7"));s["default"].use(p["a"]);const _=[{path:"/",redirect:"/tasks"},{path:"/tasks",name:"TaskList",component:m},{path:"/tasks/new",name:"TaskNew",component:g},{path:"/tasks/:id",name:"TaskDetail",component:d,props:!0},{path:"/agents",name:"AgentList",component:T},{path:"/templates",name:"TemplateList",component:E},{path:"*",redirect:"/tasks"}],h=new p["a"]({mode:"history",base:"/",routes:_,linkActiveClass:"active"});var f=h,A=a("2f62"),S=a("bc3a"),k=a.n(S);const y=k.a.create({baseURL:"http://localhost:5050/api",timeout:1e4,headers:{"Content-Type":"application/json"}});y.interceptors.request.use(t=>t,t=>Promise.reject(t)),y.interceptors.response.use(t=>{const e=t.data;return!1===e.success?Promise.reject(new Error(e.message||"操作失败")):e.data||e},t=>{let e="请求失败，请稍后再试";if(t.response){const{status:a,data:s}=t.response;switch(a){case 400:e=s.message||"请求参数错误";break;case 404:e="请求的资源不存在";break;case 500:e="服务器内部错误";break;default:e=`请求错误 (${a})`}}else t.request?e="无法连接到服务器，请检查网络":t.message&&(e=t.message);return console.error("API错误:",e),Promise.reject(new Error(e))});const b={getTasks:(t={})=>y.get("/tasks/",{params:t}),getTask:t=>y.get("/tasks/"+t),createTask:t=>y.post("/tasks/",t),updateTask:(t,e)=>y.put("/tasks/"+t,e),cancelTask:t=>y.post(`/tasks/${t}/cancel`),getTaskLog:(t,e={})=>y.get(`/tasks/${t}/log`,{params:e}),appendTaskLog:(t,e)=>y.post(`/tasks/${t}/log`,{content:e})},R={getAgents:(t={})=>y.get("/agents/",{params:t}),getAgent:t=>y.get("/agents/"+t),createMainAgent:t=>y.post("/agents/main",t),createSubAgent:t=>y.post("/agents/sub",t),cancelAgent:t=>y.post(`/agents/${t}/cancel`),sendHeartbeat:(t,e)=>y.post(`/agents/${t}/heartbeat`,e),checkAgentsStatus:()=>y.post("/agents/check-status")},v={getTemplates:(t={})=>y.get("/templates/",{params:t}),getTemplate:t=>y.get("/templates/"+t),createTemplate:t=>y.post("/templates/",t),updateTemplate:(t,e)=>y.put("/templates/"+t,e),deleteTemplate:t=>y.delete("/templates/"+t)};const O={tasks:[],task:null,pagination:{page:1,perPage:10,total:0,pages:0},filters:{status:"",name:"",template_type:""},taskLog:""},L={taskList:t=>t.tasks,taskDetail:t=>t.task,pagination:t=>t.pagination,filters:t=>t.filters,taskLog:t=>t.taskLog},w={SET_TASKS(t,{tasks:e,total:a,page:s,per_page:n,pages:r}){t.tasks=e,t.pagination.total=a,t.pagination.page=s,t.pagination.perPage=n,t.pagination.pages=r},SET_TASK(t,e){t.task=e},SET_PAGE(t,e){t.pagination.page=e},SET_FILTERS(t,e){t.filters={...t.filters,...e}},UPDATE_TASK_STATUS(t,{taskId:e,newStatus:a}){const s=t.tasks.findIndex(t=>t.id===e);-1!==s&&(t.tasks[s].status=a),t.task&&t.task.id===e&&(t.task.status=a)},SET_TASK_LOG(t,e){t.taskLog=e}},D={async fetchTasks({commit:t,state:e}){try{t("SET_LOADING",!0,{root:!0});const{page:a,perPage:s}=e.pagination,n=e.filters,r={page:a,per_page:s};n.status&&(r.status=n.status),n.name&&(r.name=n.name),n.template_type&&(r.template_type=n.template_type);const o=await b.getTasks(r);return t("SET_TASKS",{tasks:o.tasks,total:o.total,page:o.page,per_page:o.per_page,pages:o.pages}),o}catch(a){throw console.error("获取任务列表失败:",a),t("SET_ERROR",a.message||"获取任务列表失败，请稍后重试",{root:!0}),a}finally{t("SET_LOADING",!1,{root:!0})}},async fetchTask({commit:t},e){try{t("SET_LOADING",!0,{root:!0});const a=await b.getTask(e);return t("SET_TASK",a),a}catch(a){throw console.error(`获取任务${e}详情失败:`,a),t("SET_ERROR",a.message||"获取任务详情失败，请稍后重试",{root:!0}),a}finally{t("SET_LOADING",!1,{root:!0})}},async createTask({commit:t},e){try{t("SET_LOADING",!0,{root:!0});const a=await b.createTask(e);return a}catch(a){throw console.error("创建任务失败:",a),t("SET_ERROR",a.message||"创建任务失败，请检查输入并重试",{root:!0}),a}finally{t("SET_LOADING",!1,{root:!0})}},async cancelTask({commit:t},e){try{return t("SET_LOADING",!0,{root:!0}),await b.cancelTask(e),t("UPDATE_TASK_STATUS",{taskId:e,newStatus:"canceled"}),!0}catch(a){throw console.error(`取消任务${e}失败:`,a),t("SET_ERROR",a.message||"取消任务失败，请稍后重试",{root:!0}),a}finally{t("SET_LOADING",!1,{root:!0})}},async fetchTaskLog({commit:t},{taskId:e,startLine:a,maxLines:s}){try{const n={};void 0!==a&&(n.start_line=a),void 0!==s&&(n.max_lines=s);const r=await b.getTaskLog(e,n);return t("SET_TASK_LOG",r.log||""),r}catch(n){throw console.error(`获取任务${e}日志失败:`,n),n}},setPage({commit:t,dispatch:e},a){return t("SET_PAGE",a),e("fetchTasks")},setFilters({commit:t,dispatch:e},a){return t("SET_FILTERS",a),t("SET_PAGE",1),e("fetchTasks")}};var I={namespaced:!0,state:O,getters:L,mutations:w,actions:D};const N={agents:[],agentTypes:["main","sub"],loading:!1,error:null},G={allAgents:t=>t.agents,mainAgents:t=>t.agents.filter(t=>"main"===t.agent_type),subAgents:t=>t.agents.filter(t=>"sub"===t.agent_type),subAgentsByMainId:t=>e=>t.agents.filter(t=>"sub"===t.agent_type&&t.main_agent_id===e),agentResourceUsage:t=>e=>{const a=t.agents.find(t=>t.id===e);return a?{cpuUsage:a.cpu_usage||0,memoryUsage:a.memory_usage||0,gpuUsage:a.gpu_usage||[]}:null},getAgentById:t=>e=>t.agents.find(t=>t.id===e)},P={SET_AGENTS(t,e){t.agents=e},SET_LOADING(t,e){t.loading=e},SET_ERROR(t,e){t.error=e},UPDATE_AGENT_STATUS(t,{agentId:e,status:a,resourceData:s}){const n=t.agents.findIndex(t=>t.id===e);if(-1!==n){const e={...t.agents[n]};a&&(e.status=a),s&&(e.cpu_usage=s.cpu_usage||e.cpu_usage,e.memory_usage=s.memory_usage||e.memory_usage,e.gpu_usage=s.gpu_usage||e.gpu_usage),t.agents.splice(n,1,e)}},ADD_AGENT(t,e){t.agents.push(e)},REMOVE_AGENT(t,e){const a=t.agents.findIndex(t=>t.id===e);-1!==a&&t.agents.splice(a,1)}},C={async fetchAgents({commit:t},e={}){t("SET_LOADING",!0),t("SET_ERROR",null);try{const a=await R.getAgents(e);return t("SET_AGENTS",a),a}catch(a){throw t("SET_ERROR",a.message),console.error("获取Agent列表失败:",a),a}finally{t("SET_LOADING",!1)}},async fetchAgent({commit:t},e){t("SET_LOADING",!0),t("SET_ERROR",null);try{const a=await R.getAgent(e);return t("UPDATE_AGENT_STATUS",{agentId:a.id,status:a.status,resourceData:{cpu_usage:a.cpu_usage,memory_usage:a.memory_usage,gpu_usage:a.gpu_usage}}),a}catch(a){throw t("SET_ERROR",a.message),console.error(`获取Agent详情失败 (ID=${e}):`,a),a}finally{t("SET_LOADING",!1)}},async createMainAgent({commit:t},e){t("SET_LOADING",!0),t("SET_ERROR",null);try{const a=await R.createMainAgent(e);return t("ADD_AGENT",a),a}catch(a){throw t("SET_ERROR",a.message),console.error("创建主Agent失败:",a),a}finally{t("SET_LOADING",!1)}},async cancelAgent({commit:t},e){t("SET_LOADING",!0),t("SET_ERROR",null);try{return await R.cancelAgent(e),t("UPDATE_AGENT_STATUS",{agentId:e,status:"canceled"}),!0}catch(a){throw t("SET_ERROR",a.message),console.error(`取消Agent失败 (ID=${e}):`,a),a}finally{t("SET_LOADING",!1)}},async pollAgentStatus({dispatch:t}){try{await t("fetchAgents"),setTimeout(()=>{t("pollAgentStatus")},5e3)}catch(e){console.error("Agent状态轮询失败:",e),setTimeout(()=>{t("pollAgentStatus")},1e4)}},async checkAgentsStatus({dispatch:t}){try{await R.checkAgentsStatus(),t("fetchAgents")}catch(e){throw console.error("检查Agent状态失败:",e),e}},async removeAgent({commit:t},e){try{await R.cancelAgent(e),t("REMOVE_AGENT",e)}catch(a){throw console.error(`移除Agent失败 (ID=${e}):`,a),a}}};var x={namespaced:!0,state:N,getters:G,mutations:P,actions:C};const M={templates:[],template:null,loading:!1,error:null},$={allTemplates:t=>t.templates,getTemplateById:t=>e=>t.templates.find(t=>t.id===e),templateTypes:t=>[...new Set(t.templates.map(t=>t.template_type))]},j={SET_TEMPLATES(t,e){t.templates=e},SET_TEMPLATE(t,e){t.template=e},ADD_TEMPLATE(t,e){t.templates.push(e)},UPDATE_TEMPLATE(t,e){const a=t.templates.findIndex(t=>t.id===e.id);-1!==a&&t.templates.splice(a,1,e)},DELETE_TEMPLATE(t,e){t.templates=t.templates.filter(t=>t.id!==e)},SET_LOADING(t,e){t.loading=e},SET_ERROR(t,e){t.error=e}},U={async fetchTemplates({commit:t},e={}){t("SET_LOADING",!0),t("SET_ERROR",null);try{const a=await v.getTemplates(e);return t("SET_TEMPLATES",a),a}catch(a){throw t("SET_ERROR",a.message),console.error("获取模板列表失败:",a),a}finally{t("SET_LOADING",!1)}},async fetchTemplate({commit:t},e){t("SET_LOADING",!0),t("SET_ERROR",null);try{const a=await v.getTemplate(e);return t("SET_TEMPLATE",a),a}catch(a){throw t("SET_ERROR",a.message),console.error(`获取模板失败 (ID=${e}):`,a),a}finally{t("SET_LOADING",!1)}},async createTemplate({commit:t},e){t("SET_LOADING",!0),t("SET_ERROR",null);try{const a=await v.createTemplate(e);return t("ADD_TEMPLATE",a),a}catch(a){throw t("SET_ERROR",a.message),console.error("创建模板失败:",a),a}finally{t("SET_LOADING",!1)}},async updateTemplate({commit:t},{templateId:e,templateData:a}){t("SET_LOADING",!0),t("SET_ERROR",null);try{const s=await v.updateTemplate(e,a);return t("UPDATE_TEMPLATE",s),s}catch(s){throw t("SET_ERROR",s.message),console.error(`更新模板失败 (ID=${e}):`,s),s}finally{t("SET_LOADING",!1)}},async deleteTemplate({commit:t},e){t("SET_LOADING",!0),t("SET_ERROR",null);try{return await v.deleteTemplate(e),t("DELETE_TEMPLATE",e),!0}catch(a){throw t("SET_ERROR",a.message),console.error(`删除模板失败 (ID=${e}):`,a),a}finally{t("SET_LOADING",!1)}}};var K={namespaced:!0,state:M,getters:$,mutations:j,actions:U};s["default"].use(A["a"]);var B=new A["a"].Store({state:{loading:!1,error:null},mutations:{SET_LOADING(t,e){t.loading=e},SET_ERROR(t,e){t.error=e},CLEAR_ERROR(t){t.error=null}},actions:{setLoading({commit:t},e){t("SET_LOADING",e)},setError({commit:t},e){t("SET_ERROR",e)},clearError({commit:t}){t("CLEAR_ERROR")}},modules:{tasks:I,agents:x,templates:K}}),q=a("5f5b"),F=a("b1e0");a("f9e3"),a("2dd8");s["default"].use(q["a"]),s["default"].use(F["a"]),s["default"].config.errorHandler=function(t,e,a){console.error("Vue错误:",t),console.error("错误信息:",a)},s["default"].config.productionTip=!1,new s["default"]({router:f,store:B,render:t=>t(u)}).$mount("#app")},"6fd6":function(t,e,a){"use strict";a("1573")}});
//# sourceMappingURL=app.9ad90186.js.map