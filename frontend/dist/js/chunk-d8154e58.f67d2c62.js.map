{"version":3,"sources":["webpack:///./src/views/Tasks/TaskList.vue?5420","webpack:///./src/views/Tasks/TaskList.vue","webpack:///src/views/Tasks/TaskList.vue","webpack:///./src/views/Tasks/TaskList.vue?e48c","webpack:///./src/views/Tasks/TaskList.vue?ef5f"],"names":["render","_vm","this","_c","_self","staticClass","_v","attrs","statusOptions","on","applyFilters","model","value","filterStatus","callback","$$v","expression","templateTypeOptions","filterTemplateType","debounceSearch","filterName","clearFilters","tasks","fields","loading","scopedSlots","_u","key","fn","data","class","_s","getStatusText","getPriorityText","formatDate","$event","viewTaskDetail","item","id","includes","status","confirmCancel","proxy","pagination","total","perPage","changePage","currentPage","doCancelTask","selectedTask","name","error","clearError","_e","staticRenderFns","label","sortable","debounceTimer","text","computed","mapState","state","mapGetters","methods","mapActions","dateStr","moment","format","statusMap","priority","priorityMap","taskId","$router","push","task","$bvModal","show","cancelTask","$bvToast","toast","title","variant","solid","page","setPage","setFilters","template_type","clearTimeout","setTimeout","initTemplateTypeOptions","templateTypes","length","map","type","fetchTemplates","fetchTasks","console","watch","handler","immediate","component"],"mappings":"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","file":"js/chunk-d8154e58.f67d2c62.js","sourcesContent":["export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskList.vue?vue&type=style&index=0&id=627e1461&prod&scoped=true&lang=css\"","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"task-list\"},[_c('div',{staticClass:\"card mb-4\"},[_c('div',{staticClass:\"card-body\"},[_c('h5',{staticClass:\"card-title\"},[_vm._v(\"筛选条件\")]),_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-3\"},[_c('b-form-group',{attrs:{\"label\":\"状态\"}},[_c('b-form-select',{attrs:{\"options\":_vm.statusOptions},on:{\"change\":_vm.applyFilters},model:{value:(_vm.filterStatus),callback:function ($$v) {_vm.filterStatus=$$v},expression:\"filterStatus\"}})],1)],1),_c('div',{staticClass:\"col-md-3\"},[_c('b-form-group',{attrs:{\"label\":\"模板类型\"}},[_c('b-form-select',{attrs:{\"options\":_vm.templateTypeOptions},on:{\"change\":_vm.applyFilters},model:{value:(_vm.filterTemplateType),callback:function ($$v) {_vm.filterTemplateType=$$v},expression:\"filterTemplateType\"}})],1)],1),_c('div',{staticClass:\"col-md-4\"},[_c('b-form-group',{attrs:{\"label\":\"名称关键词\"}},[_c('b-form-input',{attrs:{\"placeholder\":\"输入任务名称关键词\"},on:{\"input\":_vm.debounceSearch},model:{value:(_vm.filterName),callback:function ($$v) {_vm.filterName=$$v},expression:\"filterName\"}})],1)],1),_c('div',{staticClass:\"col-md-2 d-flex align-items-end\"},[_c('b-button',{staticClass:\"w-100\",attrs:{\"variant\":\"outline-secondary\",\"size\":\"sm\"},on:{\"click\":_vm.clearFilters}},[_c('i',{staticClass:\"bi bi-x-circle mr-1\"}),_vm._v(\"清空筛选 \")])],1)])])]),_c('div',{staticClass:\"card\"},[_c('div',{staticClass:\"card-body p-0\"},[_c('b-table',{staticClass:\"mb-0\",attrs:{\"striped\":\"\",\"hover\":\"\",\"items\":_vm.tasks,\"fields\":_vm.fields,\"busy\":_vm.loading,\"show-empty\":\"\",\"empty-text\":\"没有找到任务，请调整筛选条件\",\"responsive\":\"\"},scopedSlots:_vm._u([{key:\"cell(status)\",fn:function(data){return [_c('b-badge',{class:'status-' + data.value},[_vm._v(_vm._s(_vm.getStatusText(data.value)))])]}},{key:\"cell(priority)\",fn:function(data){return [_c('b-badge',{attrs:{\"variant\":\"secondary\"}},[_vm._v(_vm._s(_vm.getPriorityText(data.value)))])]}},{key:\"cell(created_time)\",fn:function(data){return [_vm._v(\" \"+_vm._s(_vm.formatDate(data.value))+\" \")]}},{key:\"cell(actions)\",fn:function(data){return [_c('b-button-group',{attrs:{\"size\":\"sm\"}},[_c('b-button',{attrs:{\"variant\":\"outline-primary\"},on:{\"click\":function($event){return _vm.viewTaskDetail(data.item.id)}}},[_c('i',{staticClass:\"bi bi-eye\"})]),_c('b-button',{attrs:{\"variant\":\"outline-danger\",\"disabled\":!['waiting', 'blocked', 'running'].includes(data.item.status)},on:{\"click\":function($event){return _vm.confirmCancel(data.item)}}},[_c('i',{staticClass:\"bi bi-x-circle\"})])],1)]}},{key:\"table-busy\",fn:function(){return [_c('div',{staticClass:\"text-center my-2\"},[_c('b-spinner',{staticClass:\"align-middle\"}),_c('strong',[_vm._v(\" 加载中...\")])],1)]},proxy:true}])})],1),_c('div',{staticClass:\"card-footer d-flex justify-content-between align-items-center\"},[_c('small',{staticClass:\"text-muted\"},[_vm._v(\"共 \"+_vm._s(_vm.pagination.total)+\" 条记录\")]),_c('b-pagination',{staticClass:\"my-0\",attrs:{\"total-rows\":_vm.pagination.total,\"per-page\":_vm.pagination.perPage,\"limit\":5,\"align\":\"right\",\"size\":\"sm\"},on:{\"change\":_vm.changePage},model:{value:(_vm.currentPage),callback:function ($$v) {_vm.currentPage=$$v},expression:\"currentPage\"}})],1)]),_c('b-modal',{attrs:{\"id\":\"cancel-modal\",\"title\":\"取消任务\",\"ok-title\":\"确认取消\",\"ok-variant\":\"danger\",\"cancel-title\":\"返回\"},on:{\"ok\":_vm.doCancelTask}},[_c('p',[_vm._v(\"您确认要取消任务 \"),_c('strong',[_vm._v(_vm._s(_vm.selectedTask ? _vm.selectedTask.name : ''))]),_vm._v(\" 吗？\")]),_c('p',{staticClass:\"text-danger\"},[_vm._v(\"此操作不可撤销！已取消的任务将不会被执行。\")])]),(_vm.error)?_c('b-alert',{staticClass:\"mt-3\",attrs:{\"variant\":\"danger\",\"dismissible\":\"\",\"show\":\"\"},on:{\"dismissed\":_vm.clearError}},[_vm._v(\" \"+_vm._s(_vm.error)+\" \")]):_vm._e()],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n  <div class=\"task-list\">\r\n    <!-- 任务过滤器 -->\r\n    <div class=\"card mb-4\">\r\n      <div class=\"card-body\">\r\n        <h5 class=\"card-title\">筛选条件</h5>\r\n        <div class=\"row\">\r\n          <div class=\"col-md-3\">\r\n            <b-form-group label=\"状态\">\r\n              <b-form-select v-model=\"filterStatus\" :options=\"statusOptions\" @change=\"applyFilters\"></b-form-select>\r\n            </b-form-group>\r\n          </div>\r\n          <div class=\"col-md-3\">\r\n            <b-form-group label=\"模板类型\">\r\n              <b-form-select v-model=\"filterTemplateType\" :options=\"templateTypeOptions\" @change=\"applyFilters\"></b-form-select>\r\n            </b-form-group>\r\n          </div>\r\n          <div class=\"col-md-4\">\r\n            <b-form-group label=\"名称关键词\">\r\n              <b-form-input v-model=\"filterName\" placeholder=\"输入任务名称关键词\" @input=\"debounceSearch\"></b-form-input>\r\n            </b-form-group>\r\n          </div>\r\n          <div class=\"col-md-2 d-flex align-items-end\">\r\n            <b-button variant=\"outline-secondary\" size=\"sm\" @click=\"clearFilters\" class=\"w-100\">\r\n              <i class=\"bi bi-x-circle mr-1\"></i>清空筛选\r\n            </b-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- 任务表格 -->\r\n    <div class=\"card\">\r\n      <div class=\"card-body p-0\">\r\n        <b-table \r\n          striped \r\n          hover \r\n          :items=\"tasks\" \r\n          :fields=\"fields\"\r\n          :busy=\"loading\"\r\n          show-empty\r\n          empty-text=\"没有找到任务，请调整筛选条件\"\r\n          responsive\r\n          class=\"mb-0\"\r\n        >\r\n          <!-- 状态列 -->\r\n          <template #cell(status)=\"data\">\r\n            <b-badge :class=\"'status-' + data.value\">{{ getStatusText(data.value) }}</b-badge>\r\n          </template>\r\n          \r\n          <!-- 优先级列 -->\r\n          <template #cell(priority)=\"data\">\r\n            <b-badge variant=\"secondary\">{{ getPriorityText(data.value) }}</b-badge>\r\n          </template>\r\n          \r\n          <!-- 创建时间列 -->\r\n          <template #cell(created_time)=\"data\">\r\n            {{ formatDate(data.value) }}\r\n          </template>\r\n          \r\n          <!-- 操作列 -->\r\n          <template #cell(actions)=\"data\">\r\n            <b-button-group size=\"sm\">\r\n              <b-button variant=\"outline-primary\" @click=\"viewTaskDetail(data.item.id)\">\r\n                <i class=\"bi bi-eye\"></i>\r\n              </b-button>\r\n              <b-button \r\n                variant=\"outline-danger\" \r\n                @click=\"confirmCancel(data.item)\" \r\n                :disabled=\"!['waiting', 'blocked', 'running'].includes(data.item.status)\"\r\n              >\r\n                <i class=\"bi bi-x-circle\"></i>\r\n              </b-button>\r\n            </b-button-group>\r\n          </template>\r\n          \r\n          <!-- 加载中提示 -->\r\n          <template #table-busy>\r\n            <div class=\"text-center my-2\">\r\n              <b-spinner class=\"align-middle\"></b-spinner>\r\n              <strong> 加载中...</strong>\r\n            </div>\r\n          </template>\r\n        </b-table>\r\n      </div>\r\n      \r\n      <!-- 分页 -->\r\n      <div class=\"card-footer d-flex justify-content-between align-items-center\">\r\n        <small class=\"text-muted\">共 {{ pagination.total }} 条记录</small>\r\n        <b-pagination\r\n          v-model=\"currentPage\"\r\n          :total-rows=\"pagination.total\"\r\n          :per-page=\"pagination.perPage\"\r\n          :limit=\"5\"\r\n          align=\"right\"\r\n          size=\"sm\"\r\n          class=\"my-0\"\r\n          @change=\"changePage\"\r\n        ></b-pagination>\r\n      </div>\r\n    </div>\r\n    \r\n    <!-- 取消任务确认框 -->\r\n    <b-modal \r\n      id=\"cancel-modal\" \r\n      title=\"取消任务\" \r\n      ok-title=\"确认取消\" \r\n      ok-variant=\"danger\"\r\n      cancel-title=\"返回\"\r\n      @ok=\"doCancelTask\"\r\n    >\r\n      <p>您确认要取消任务 <strong>{{ selectedTask ? selectedTask.name : '' }}</strong> 吗？</p>\r\n      <p class=\"text-danger\">此操作不可撤销！已取消的任务将不会被执行。</p>\r\n    </b-modal>\r\n    \r\n    <!-- 全局错误提示 -->\r\n    <b-alert \r\n      v-if=\"error\" \r\n      variant=\"danger\" \r\n      dismissible \r\n      show \r\n      class=\"mt-3\"\r\n      @dismissed=\"clearError\"\r\n    >\r\n      {{ error }}\r\n    </b-alert>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport { mapState, mapGetters, mapActions } from 'vuex'\r\nimport moment from 'moment'\r\n\r\nexport default {\r\n  name: 'TaskList',\r\n  \r\n  data() {\r\n    return {\r\n      fields: [\r\n        { key: 'id', label: 'ID', sortable: true },\r\n        { key: 'name', label: '任务名称', sortable: true },\r\n        { key: 'template_type', label: '模板类型', sortable: true },\r\n        { key: 'priority', label: '优先级', sortable: true },\r\n        { key: 'status', label: '状态', sortable: true },\r\n        { key: 'created_time', label: '创建时间', sortable: true },\r\n        { key: 'actions', label: '操作' }\r\n      ],\r\n      selectedTask: null,\r\n      currentPage: 1,\r\n      debounceTimer: null,\r\n      filterStatus: '',\r\n      filterName: '',\r\n      filterTemplateType: '',\r\n      statusOptions: [\r\n        { value: '', text: '全部状态' },\r\n        { value: 'waiting', text: '等待中' },\r\n        { value: 'blocked', text: '被阻塞' },\r\n        { value: 'running', text: '运行中' },\r\n        { value: 'completed', text: '已完成' },\r\n        { value: 'failed', text: '失败' },\r\n        { value: 'canceled', text: '已取消' }\r\n      ],\r\n      templateTypeOptions: [\r\n        { value: '', text: '全部类型' }\r\n        // 其他模板类型将在created生命周期中从后端获取\r\n      ]\r\n    }\r\n  },\r\n  \r\n  computed: {\r\n    ...mapState({\r\n      tasks: state => state.tasks.tasks,\r\n      pagination: state => state.tasks.pagination,\r\n      loading: state => state.loading,\r\n      error: state => state.error\r\n    }),\r\n    ...mapGetters('templates', ['templateTypes'])\r\n  },\r\n  \r\n  methods: {\r\n    ...mapActions('tasks', [\r\n      'fetchTasks',\r\n      'setPage',\r\n      'setFilters',\r\n      'cancelTask'\r\n    ]),\r\n    ...mapActions('templates', ['fetchTemplates']),\r\n    ...mapActions(['clearError']),\r\n    \r\n    // 格式化日期\r\n    formatDate(dateStr) {\r\n      return moment(dateStr).format('YYYY-MM-DD HH:mm:ss')\r\n    },\r\n    \r\n    // 获取状态文本\r\n    getStatusText(status) {\r\n      const statusMap = {\r\n        'waiting': '等待中',\r\n        'blocked': '被阻塞',\r\n        'running': '运行中',\r\n        'completed': '已完成',\r\n        'failed': '失败',\r\n        'canceled': '已取消'\r\n      }\r\n      return statusMap[status] || status\r\n    },\r\n    \r\n    // 获取优先级文本\r\n    getPriorityText(priority) {\r\n      const priorityMap = {\r\n        1: '最高',\r\n        2: '高',\r\n        3: '中',\r\n        4: '低',\r\n        5: '最低'\r\n      }\r\n      return priorityMap[priority] || priority\r\n    },\r\n    \r\n    // 查看任务详情\r\n    viewTaskDetail(taskId) {\r\n      this.$router.push(`/tasks/${taskId}`)\r\n    },\r\n    \r\n    // 确认取消任务\r\n    confirmCancel(task) {\r\n      this.selectedTask = task\r\n      this.$bvModal.show('cancel-modal')\r\n    },\r\n    \r\n    // 执行取消任务\r\n    async doCancelTask() {\r\n      if (!this.selectedTask) return\r\n      \r\n      try {\r\n        await this.cancelTask(this.selectedTask.id)\r\n        this.$bvToast.toast('任务已成功取消', {\r\n          title: '操作成功',\r\n          variant: 'success',\r\n          solid: true\r\n        })\r\n      } catch (error) {\r\n        // 错误已经在action中处理\r\n      }\r\n    },\r\n    \r\n    // 更改页码\r\n    changePage(page) {\r\n      this.currentPage = page\r\n      this.setPage(page)\r\n    },\r\n    \r\n    // 应用筛选条件\r\n    applyFilters() {\r\n      this.setFilters({\r\n        status: this.filterStatus,\r\n        name: this.filterName,\r\n        template_type: this.filterTemplateType\r\n      })\r\n    },\r\n    \r\n    // 延迟搜索（防抖）\r\n    debounceSearch() {\r\n      clearTimeout(this.debounceTimer)\r\n      this.debounceTimer = setTimeout(() => {\r\n        this.applyFilters()\r\n      }, 500)\r\n    },\r\n    \r\n    // 清空筛选条件\r\n    clearFilters() {\r\n      this.filterStatus = ''\r\n      this.filterName = ''\r\n      this.filterTemplateType = ''\r\n      this.applyFilters()\r\n    },\r\n    \r\n    // 初始化模板类型选项\r\n    initTemplateTypeOptions() {\r\n      if (this.templateTypes && this.templateTypes.length > 0) {\r\n        // 从vuex中获取模板类型并创建选项\r\n        this.templateTypeOptions = [\r\n          { value: '', text: '全部类型' },\r\n          ...this.templateTypes.map(type => ({ value: type, text: type }))\r\n        ]\r\n      }\r\n    }\r\n  },\r\n  \r\n  async created() {\r\n    try {\r\n      // 获取模板列表以填充模板类型选项\r\n      await this.fetchTemplates()\r\n      this.initTemplateTypeOptions()\r\n      \r\n      // 获取任务列表\r\n      this.currentPage = this.pagination.page\r\n      await this.fetchTasks()\r\n    } catch (error) {\r\n      console.error('初始化任务列表失败:', error)\r\n    }\r\n  },\r\n  \r\n  watch: {\r\n    // 监听模板类型变化，更新下拉选项\r\n    templateTypes: {\r\n      handler: 'initTemplateTypeOptions',\r\n      immediate: true\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.card-body {\r\n  padding: 1.25rem;\r\n}\r\n\r\n.pagination {\r\n  margin-bottom: 0;\r\n}\r\n\r\n/* 状态标签样式已在App.vue中定义 */\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskList.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskList.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./TaskList.vue?vue&type=template&id=627e1461&scoped=true\"\nimport script from \"./TaskList.vue?vue&type=script&lang=js\"\nexport * from \"./TaskList.vue?vue&type=script&lang=js\"\nimport style0 from \"./TaskList.vue?vue&type=style&index=0&id=627e1461&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"627e1461\",\n  null\n  \n)\n\nexport default component.exports"],"sourceRoot":""}