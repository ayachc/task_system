{"version":3,"sources":["webpack:///./src/views/Tasks/TaskDetail.vue","webpack:///src/views/Tasks/TaskDetail.vue","webpack:///./src/views/Tasks/TaskDetail.vue?b71e","webpack:///./src/views/Tasks/TaskDetail.vue?a35d","webpack:///./src/views/Tasks/TaskDetail.vue?269c"],"names":["render","_vm","this","_c","_self","staticClass","loading","attrs","_v","task","status","_e","class","_s","getStatusText","id","name","template_type","getPriorityText","priority","formatDate","created_time","start_time","end_time","execution_time","formatDuration","agent_id","_m","cpu_cores","gpu_count","gpu_memory","depends_on","length","_l","dependId","key","on","$event","viewTaskDetail","directives","rawName","modifiers","script_content","refreshLog","model","value","autoRefresh","callback","$$v","expression","ref","taskLog","$router","push","includes","confirmCancel","cancelTask","staticRenderFns","props","type","String","Number","required","data","refreshInterval","computed","mapState","state","tasks","error","methods","mapActions","dateStr","moment","format","seconds","hours","Math","floor","minutes","remainingSeconds","result","statusMap","priorityMap","taskId","$bvModal","show","response","fetchTaskLog","log","$nextTick","$refs","logContainer","scrollTop","scrollHeight","console","fetchTask","$bvToast","toast","title","variant","solid","updateTaskData","startAutoRefresh","stopAutoRefresh","setInterval","clearInterval","beforeDestroy","watch","handler","immediate","newVal","newStatus","component"],"mappings":"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","file":"js/chunk-187406d0.2fa674f5.js","sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"task-detail\"},[(_vm.loading)?_c('div',{staticClass:\"text-center my-5\"},[_c('b-spinner',{attrs:{\"variant\":\"primary\"}}),_c('p',{staticClass:\"mt-2\"},[_vm._v(\"加载任务详情...\")])],1):(!_vm.task)?_c('div',{staticClass:\"alert alert-danger\"},[_vm._v(\" 任务不存在或已被删除 \")]):_c('div',[(_vm.task.status === 'failed')?_c('b-alert',{staticClass:\"mb-4\",attrs:{\"show\":\"\",\"variant\":\"danger\"}},[_c('h5',[_c('i',{staticClass:\"bi bi-exclamation-triangle-fill mr-2\"}),_vm._v(\"任务执行失败\")]),_vm._v(\" 请查看日志了解详细错误信息 \")]):_vm._e(),_c('div',{staticClass:\"card mb-4\"},[_c('div',{staticClass:\"card-header d-flex justify-content-between align-items-center\"},[_c('h5',{staticClass:\"mb-0\"},[_vm._v(\"任务信息\")]),_c('b-badge',{class:'status-' + _vm.task.status},[_vm._v(_vm._s(_vm.getStatusText(_vm.task.status)))])],1),_c('div',{staticClass:\"card-body\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-6\"},[_c('dl',{staticClass:\"row mb-0\"},[_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"ID\")]),_c('dd',{staticClass:\"col-sm-8\"},[_vm._v(_vm._s(_vm.task.id))]),_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"名称\")]),_c('dd',{staticClass:\"col-sm-8\"},[_vm._v(_vm._s(_vm.task.name))]),_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"模板类型\")]),_c('dd',{staticClass:\"col-sm-8\"},[_vm._v(_vm._s(_vm.task.template_type))]),_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"优先级\")]),_c('dd',{staticClass:\"col-sm-8\"},[_c('b-badge',{attrs:{\"variant\":\"secondary\"}},[_vm._v(_vm._s(_vm.getPriorityText(_vm.task.priority)))])],1),_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"状态\")]),_c('dd',{staticClass:\"col-sm-8\"},[_c('b-badge',{class:'status-' + _vm.task.status},[_vm._v(\" \"+_vm._s(_vm.getStatusText(_vm.task.status))+\" \")])],1)])]),_c('div',{staticClass:\"col-md-6\"},[_c('dl',{staticClass:\"row mb-0\"},[_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"创建时间\")]),_c('dd',{staticClass:\"col-sm-8\"},[_vm._v(_vm._s(_vm.formatDate(_vm.task.created_time)))]),_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"开始时间\")]),_c('dd',{staticClass:\"col-sm-8\"},[_vm._v(_vm._s(_vm.task.start_time ? _vm.formatDate(_vm.task.start_time) : '尚未开始'))]),_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"结束时间\")]),_c('dd',{staticClass:\"col-sm-8\"},[_vm._v(_vm._s(_vm.task.end_time ? _vm.formatDate(_vm.task.end_time) : '尚未结束'))]),_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"执行耗时\")]),_c('dd',{staticClass:\"col-sm-8\"},[_vm._v(_vm._s(_vm.task.execution_time ? _vm.formatDuration(_vm.task.execution_time) : '尚未完成'))]),_c('dt',{staticClass:\"col-sm-4\"},[_vm._v(\"执行Agent\")]),_c('dd',{staticClass:\"col-sm-8\"},[_vm._v(_vm._s(_vm.task.agent_id || '尚未分配'))])])])])])]),_c('div',{staticClass:\"card mb-4\"},[_vm._m(0),_c('div',{staticClass:\"card-body\"},[_c('div',{staticClass:\"row\"},[_c('div',{staticClass:\"col-md-4\"},[_c('div',{staticClass:\"d-flex align-items-center\"},[_vm._m(1),_c('div',[_c('div',{staticClass:\"text-muted small\"},[_vm._v(\"CPU核心数\")]),_c('div',{staticClass:\"font-weight-bold\"},[_vm._v(_vm._s(_vm.task.cpu_cores || 1))])])])]),_c('div',{staticClass:\"col-md-4\"},[_c('div',{staticClass:\"d-flex align-items-center\"},[_vm._m(2),_c('div',[_c('div',{staticClass:\"text-muted small\"},[_vm._v(\"GPU数量\")]),_c('div',{staticClass:\"font-weight-bold\"},[_vm._v(_vm._s(_vm.task.gpu_count || 0))])])])]),_c('div',{staticClass:\"col-md-4\"},[_c('div',{staticClass:\"d-flex align-items-center\"},[_vm._m(3),_c('div',[_c('div',{staticClass:\"text-muted small\"},[_vm._v(\"GPU显存(GB/卡)\")]),_c('div',{staticClass:\"font-weight-bold\"},[_vm._v(_vm._s(_vm.task.gpu_memory || 0))])])])])])])]),(_vm.task.depends_on && _vm.task.depends_on.length > 0)?_c('div',{staticClass:\"card mb-4\"},[_vm._m(4),_c('div',{staticClass:\"card-body\"},[_c('div',{staticClass:\"list-group\"},_vm._l((_vm.task.depends_on),function(dependId){return _c('div',{key:dependId,staticClass:\"list-group-item list-group-item-action d-flex justify-content-between align-items-center\"},[_c('span',[_vm._v(\"任务 #\"+_vm._s(dependId))]),_c('b-button',{attrs:{\"size\":\"sm\",\"variant\":\"outline-primary\"},on:{\"click\":function($event){return _vm.viewTaskDetail(dependId)}}},[_vm._v(\"查看\")])],1)}),0)])]):_vm._e(),_c('div',{staticClass:\"card mb-4\"},[_c('div',{staticClass:\"card-header d-flex justify-content-between align-items-center\"},[_c('h5',{staticClass:\"mb-0\"},[_vm._v(\"脚本内容\")]),_c('b-button',{directives:[{name:\"b-toggle\",rawName:\"v-b-toggle.script-collapse\",modifiers:{\"script-collapse\":true}}],attrs:{\"size\":\"sm\",\"variant\":\"outline-secondary\"}},[_c('i',{staticClass:\"bi bi-code-slash mr-1\"}),_vm._v(\" 显示/隐藏 \")])],1),_c('b-collapse',{attrs:{\"id\":\"script-collapse\",\"visible\":\"\"}},[_c('div',{staticClass:\"card-body p-0\"},[_c('pre',{staticClass:\"script-content\"},[_vm._v(_vm._s(_vm.task.script_content))])])])],1),_c('div',{staticClass:\"card\"},[_c('div',{staticClass:\"card-header d-flex justify-content-between align-items-center\"},[_c('h5',{staticClass:\"mb-0\"},[_vm._v(\"执行日志\")]),_c('div',[_c('b-button',{staticClass:\"mr-2\",attrs:{\"size\":\"sm\",\"variant\":\"outline-secondary\"},on:{\"click\":_vm.refreshLog}},[_c('i',{staticClass:\"bi bi-arrow-clockwise mr-1\"}),_vm._v(\" 刷新 \")]),_c('b-form-checkbox',{staticClass:\"d-inline-block ml-2\",attrs:{\"switch\":\"\"},model:{value:(_vm.autoRefresh),callback:function ($$v) {_vm.autoRefresh=$$v},expression:\"autoRefresh\"}},[_vm._v(\" 自动刷新 \")])],1)]),_c('div',{staticClass:\"card-body p-0\"},[_c('div',{ref:\"logContainer\",staticClass:\"log-container\"},[(_vm.taskLog)?_c('pre',{staticClass:\"log-content m-0 p-3\"},[_vm._v(_vm._s(_vm.taskLog))]):_c('div',{staticClass:\"text-center py-4 text-muted\"},[_c('p',[_vm._v(\"暂无日志信息\")])])])])]),_c('div',{staticClass:\"mt-4 d-flex justify-content-between\"},[_c('b-button',{attrs:{\"variant\":\"secondary\"},on:{\"click\":function($event){return _vm.$router.push('/tasks')}}},[_vm._v(\"返回任务列表\")]),(['waiting', 'blocked', 'running'].includes(_vm.task.status))?_c('b-button',{attrs:{\"variant\":\"danger\"},on:{\"click\":_vm.confirmCancel}},[_vm._v(\" 取消任务 \")]):_vm._e()],1),_c('b-modal',{attrs:{\"id\":\"cancel-modal\",\"title\":\"取消任务\",\"ok-title\":\"确认取消\",\"ok-variant\":\"danger\",\"cancel-title\":\"返回\"},on:{\"ok\":_vm.cancelTask}},[_c('p',[_vm._v(\"您确认要取消任务 \"),_c('strong',[_vm._v(_vm._s(_vm.task ? _vm.task.name : ''))]),_vm._v(\" 吗？\")]),_c('p',{staticClass:\"text-danger\"},[_vm._v(\"此操作不可撤销！\")])])],1)])\n}\nvar staticRenderFns = [function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"card-header\"},[_c('h5',{staticClass:\"mb-0\"},[_vm._v(\"资源需求\")])])\n},function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"mr-2 resource-icon\"},[_c('i',{staticClass:\"bi bi-cpu\"})])\n},function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"mr-2 resource-icon\"},[_c('i',{staticClass:\"bi bi-gpu-card\"})])\n},function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"mr-2 resource-icon\"},[_c('i',{staticClass:\"bi bi-memory\"})])\n},function (){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"card-header\"},[_c('h5',{staticClass:\"mb-0\"},[_vm._v(\"依赖任务\")])])\n}]\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"task-detail\">\n    <!-- 加载中提示 -->\n    <div v-if=\"loading\" class=\"text-center my-5\">\n      <b-spinner variant=\"primary\"></b-spinner>\n      <p class=\"mt-2\">加载任务详情...</p>\n    </div>\n    \n    <div v-else-if=\"!task\" class=\"alert alert-danger\">\n      任务不存在或已被删除\n    </div>\n    \n    <div v-else>\n      <!-- 错误提示 -->\n      <b-alert v-if=\"task.status === 'failed'\" show variant=\"danger\" class=\"mb-4\">\n        <h5><i class=\"bi bi-exclamation-triangle-fill mr-2\"></i>任务执行失败</h5>\n        请查看日志了解详细错误信息\n      </b-alert>\n      \n      <!-- 任务信息卡片 -->\n      <div class=\"card mb-4\">\n        <div class=\"card-header d-flex justify-content-between align-items-center\">\n          <h5 class=\"mb-0\">任务信息</h5>\n          <b-badge :class=\"'status-' + task.status\">{{ getStatusText(task.status) }}</b-badge>\n        </div>\n        \n        <div class=\"card-body\">\n          <div class=\"row\">\n            <div class=\"col-md-6\">\n              <dl class=\"row mb-0\">\n                <dt class=\"col-sm-4\">ID</dt>\n                <dd class=\"col-sm-8\">{{ task.id }}</dd>\n                \n                <dt class=\"col-sm-4\">名称</dt>\n                <dd class=\"col-sm-8\">{{ task.name }}</dd>\n                \n                <dt class=\"col-sm-4\">模板类型</dt>\n                <dd class=\"col-sm-8\">{{ task.template_type }}</dd>\n                \n                <dt class=\"col-sm-4\">优先级</dt>\n                <dd class=\"col-sm-8\">\n                  <b-badge variant=\"secondary\">{{ getPriorityText(task.priority) }}</b-badge>\n                </dd>\n                \n                <dt class=\"col-sm-4\">状态</dt>\n                <dd class=\"col-sm-8\">\n                  <b-badge :class=\"'status-' + task.status\">\n                    {{ getStatusText(task.status) }}\n                  </b-badge>\n                </dd>\n              </dl>\n            </div>\n            \n            <div class=\"col-md-6\">\n              <dl class=\"row mb-0\">\n                <dt class=\"col-sm-4\">创建时间</dt>\n                <dd class=\"col-sm-8\">{{ formatDate(task.created_time) }}</dd>\n                \n                <dt class=\"col-sm-4\">开始时间</dt>\n                <dd class=\"col-sm-8\">{{ task.start_time ? formatDate(task.start_time) : '尚未开始' }}</dd>\n                \n                <dt class=\"col-sm-4\">结束时间</dt>\n                <dd class=\"col-sm-8\">{{ task.end_time ? formatDate(task.end_time) : '尚未结束' }}</dd>\n                \n                <dt class=\"col-sm-4\">执行耗时</dt>\n                <dd class=\"col-sm-8\">{{ task.execution_time ? formatDuration(task.execution_time) : '尚未完成' }}</dd>\n                \n                <dt class=\"col-sm-4\">执行Agent</dt>\n                <dd class=\"col-sm-8\">{{ task.agent_id || '尚未分配' }}</dd>\n              </dl>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 资源需求卡片 -->\n      <div class=\"card mb-4\">\n        <div class=\"card-header\">\n          <h5 class=\"mb-0\">资源需求</h5>\n        </div>\n        \n        <div class=\"card-body\">\n          <div class=\"row\">\n            <div class=\"col-md-4\">\n              <div class=\"d-flex align-items-center\">\n                <div class=\"mr-2 resource-icon\">\n                  <i class=\"bi bi-cpu\"></i>\n                </div>\n                <div>\n                  <div class=\"text-muted small\">CPU核心数</div>\n                  <div class=\"font-weight-bold\">{{ task.cpu_cores || 1 }}</div>\n                </div>\n              </div>\n            </div>\n            \n            <div class=\"col-md-4\">\n              <div class=\"d-flex align-items-center\">\n                <div class=\"mr-2 resource-icon\">\n                  <i class=\"bi bi-gpu-card\"></i>\n                </div>\n                <div>\n                  <div class=\"text-muted small\">GPU数量</div>\n                  <div class=\"font-weight-bold\">{{ task.gpu_count || 0 }}</div>\n                </div>\n              </div>\n            </div>\n            \n            <div class=\"col-md-4\">\n              <div class=\"d-flex align-items-center\">\n                <div class=\"mr-2 resource-icon\">\n                  <i class=\"bi bi-memory\"></i>\n                </div>\n                <div>\n                  <div class=\"text-muted small\">GPU显存(GB/卡)</div>\n                  <div class=\"font-weight-bold\">{{ task.gpu_memory || 0 }}</div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 依赖任务 -->\n      <div v-if=\"task.depends_on && task.depends_on.length > 0\" class=\"card mb-4\">\n        <div class=\"card-header\">\n          <h5 class=\"mb-0\">依赖任务</h5>\n        </div>\n        \n        <div class=\"card-body\">\n          <div class=\"list-group\">\n            <div v-for=\"dependId in task.depends_on\" :key=\"dependId\" class=\"list-group-item list-group-item-action d-flex justify-content-between align-items-center\">\n              <span>任务 #{{ dependId }}</span>\n              <b-button size=\"sm\" variant=\"outline-primary\" @click=\"viewTaskDetail(dependId)\">查看</b-button>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 脚本内容 -->\n      <div class=\"card mb-4\">\n        <div class=\"card-header d-flex justify-content-between align-items-center\">\n          <h5 class=\"mb-0\">脚本内容</h5>\n          <b-button size=\"sm\" variant=\"outline-secondary\" v-b-toggle.script-collapse>\n            <i class=\"bi bi-code-slash mr-1\"></i> 显示/隐藏\n          </b-button>\n        </div>\n        \n        <b-collapse id=\"script-collapse\" visible>\n          <div class=\"card-body p-0\">\n            <pre class=\"script-content\">{{ task.script_content }}</pre>\n          </div>\n        </b-collapse>\n      </div>\n      \n      <!-- 执行日志 -->\n      <div class=\"card\">\n        <div class=\"card-header d-flex justify-content-between align-items-center\">\n          <h5 class=\"mb-0\">执行日志</h5>\n          <div>\n            <b-button size=\"sm\" variant=\"outline-secondary\" class=\"mr-2\" @click=\"refreshLog\">\n              <i class=\"bi bi-arrow-clockwise mr-1\"></i> 刷新\n            </b-button>\n            <b-form-checkbox v-model=\"autoRefresh\" switch class=\"d-inline-block ml-2\">\n              自动刷新\n            </b-form-checkbox>\n          </div>\n        </div>\n        \n        <div class=\"card-body p-0\">\n          <div class=\"log-container\" ref=\"logContainer\">\n            <pre class=\"log-content m-0 p-3\" v-if=\"taskLog\">{{ taskLog }}</pre>\n            <div v-else class=\"text-center py-4 text-muted\">\n              <p>暂无日志信息</p>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <!-- 操作按钮 -->\n      <div class=\"mt-4 d-flex justify-content-between\">\n        <b-button variant=\"secondary\" @click=\"$router.push('/tasks')\">返回任务列表</b-button>\n        \n        <b-button \n          v-if=\"['waiting', 'blocked', 'running'].includes(task.status)\"\n          variant=\"danger\" \n          @click=\"confirmCancel\"\n        >\n          取消任务\n        </b-button>\n      </div>\n      \n      <!-- 取消任务确认框 -->\n      <b-modal \n        id=\"cancel-modal\" \n        title=\"取消任务\" \n        ok-title=\"确认取消\" \n        ok-variant=\"danger\"\n        cancel-title=\"返回\"\n        @ok=\"cancelTask\"\n      >\n        <p>您确认要取消任务 <strong>{{ task ? task.name : '' }}</strong> 吗？</p>\n        <p class=\"text-danger\">此操作不可撤销！</p>\n      </b-modal>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapState, mapActions } from 'vuex'\nimport moment from 'moment'\n\nexport default {\n  name: 'TaskDetail',\n  \n  props: {\n    id: {\n      type: [String, Number],\n      required: true\n    }\n  },\n  \n  data() {\n    return {\n      taskLog: '',\n      autoRefresh: true,\n      refreshInterval: null\n    }\n  },\n  \n  computed: {\n    ...mapState({\n      task: state => state.tasks.task,\n      loading: state => state.loading,\n      error: state => state.error\n    })\n  },\n  \n  methods: {\n    ...mapActions('tasks', [\n      'fetchTask',\n      'fetchTaskLog',\n      'cancelTask'\n    ]),\n    ...mapActions(['clearError']),\n    \n    // 格式化日期\n    formatDate(dateStr) {\n      if (!dateStr) return ''\n      return moment(dateStr).format('YYYY-MM-DD HH:mm:ss')\n    },\n    \n    // 格式化持续时间（秒转为易读格式）\n    formatDuration(seconds) {\n      if (!seconds) return '0秒'\n      \n      const hours = Math.floor(seconds / 3600)\n      const minutes = Math.floor((seconds % 3600) / 60)\n      const remainingSeconds = seconds % 60\n      \n      let result = ''\n      if (hours > 0) result += `${hours}小时 `\n      if (minutes > 0) result += `${minutes}分钟 `\n      if (remainingSeconds > 0 || !result) result += `${remainingSeconds}秒`\n      \n      return result\n    },\n    \n    // 获取状态文本\n    getStatusText(status) {\n      const statusMap = {\n        'waiting': '等待中',\n        'blocked': '被阻塞',\n        'running': '运行中',\n        'completed': '已完成',\n        'failed': '失败',\n        'canceled': '已取消'\n      }\n      return statusMap[status] || status\n    },\n    \n    // 获取优先级文本\n    getPriorityText(priority) {\n      const priorityMap = {\n        1: '最高',\n        2: '高',\n        3: '中',\n        4: '低',\n        5: '最低'\n      }\n      return priorityMap[priority] || priority\n    },\n    \n    // 跳转到其他任务详情\n    viewTaskDetail(taskId) {\n      this.$router.push(`/tasks/${taskId}`)\n    },\n    \n    // 确认取消任务\n    confirmCancel() {\n      this.$bvModal.show('cancel-modal')\n    },\n    \n    // 刷新日志\n    async refreshLog() {\n      try {\n        const response = await this.fetchTaskLog({\n          taskId: this.id\n        })\n        this.taskLog = response.log || ''\n        \n        // 自动滚动到日志底部\n        this.$nextTick(() => {\n          if (this.$refs.logContainer) {\n            this.$refs.logContainer.scrollTop = this.$refs.logContainer.scrollHeight\n          }\n        })\n      } catch (error) {\n        console.error('获取任务日志失败:', error)\n      }\n    },\n    \n    // 更新任务状态和日志\n    async updateTaskData() {\n      await this.fetchTask(this.id)\n      await this.refreshLog()\n    },\n    \n    // 执行任务取消\n    async cancelTask() {\n      try {\n        await this.cancelTask(this.id)\n        \n        this.$bvToast.toast('任务已成功取消', {\n          title: '操作成功',\n          variant: 'success',\n          solid: true\n        })\n        \n        // 更新任务状态\n        await this.updateTaskData()\n      } catch (error) {\n        // 错误已经在action中处理\n      }\n    },\n    \n    // 开始自动刷新\n    startAutoRefresh() {\n      this.stopAutoRefresh() // 先清除现有定时器\n      \n      if (this.autoRefresh && this.task && ['running', 'waiting', 'blocked'].includes(this.task.status)) {\n        this.refreshInterval = setInterval(() => {\n          this.updateTaskData()\n        }, 5000) // 每5秒刷新一次\n      }\n    },\n    \n    // 停止自动刷新\n    stopAutoRefresh() {\n      if (this.refreshInterval) {\n        clearInterval(this.refreshInterval)\n        this.refreshInterval = null\n      }\n    }\n  },\n  \n  async created() {\n    // 初始加载任务数据\n    await this.updateTaskData()\n    \n    // 设置自动刷新\n    this.startAutoRefresh()\n  },\n  \n  beforeDestroy() {\n    // 清除定时器\n    this.stopAutoRefresh()\n  },\n  \n  watch: {\n    // 监听ID变化，重新加载数据\n    id: {\n      handler: 'updateTaskData',\n      immediate: true\n    },\n    \n    // 监听自动刷新开关\n    autoRefresh(newVal) {\n      if (newVal) {\n        this.startAutoRefresh()\n      } else {\n        this.stopAutoRefresh()\n      }\n    },\n    \n    // 监听任务状态，自动停止刷新\n    'task.status'(newStatus) {\n      if (!['running', 'waiting', 'blocked'].includes(newStatus)) {\n        this.autoRefresh = false\n      }\n    }\n  }\n}\n</script>\n\n<style scoped>\n.resource-icon {\n  font-size: 1.5rem;\n  width: 40px;\n  height: 40px;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  background-color: rgba(0, 123, 255, 0.1);\n  border-radius: 50%;\n  color: #007bff;\n}\n\n.log-container {\n  max-height: 500px;\n  overflow-y: auto;\n  background-color: #212529;\n  color: #f8f9fa;\n}\n\n.script-content {\n  padding: 1rem;\n  background-color: #f8f9fa;\n  border-radius: 0.25rem;\n  white-space: pre-wrap;\n  font-family: monospace;\n  font-size: 0.875rem;\n  max-height: 300px;\n  overflow-y: auto;\n}\n\n.log-content {\n  font-family: 'Courier New', Courier, monospace;\n  font-size: 0.85rem;\n  white-space: pre-wrap;\n}\n</style>\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskDetail.vue?vue&type=script&lang=js\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--13-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskDetail.vue?vue&type=script&lang=js\"","import { render, staticRenderFns } from \"./TaskDetail.vue?vue&type=template&id=60909941&scoped=true\"\nimport script from \"./TaskDetail.vue?vue&type=script&lang=js\"\nexport * from \"./TaskDetail.vue?vue&type=script&lang=js\"\nimport style0 from \"./TaskDetail.vue?vue&type=style&index=0&id=60909941&prod&scoped=true&lang=css\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"60909941\",\n  null\n  \n)\n\nexport default component.exports","export * from \"-!../../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--7-oneOf-1-0!../../../node_modules/css-loader/dist/cjs.js??ref--7-oneOf-1-1!../../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../node_modules/postcss-loader/src/index.js??ref--7-oneOf-1-2!../../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./TaskDetail.vue?vue&type=style&index=0&id=60909941&prod&scoped=true&lang=css\""],"sourceRoot":""}