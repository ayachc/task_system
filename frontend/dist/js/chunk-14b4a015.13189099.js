(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-14b4a015"],{2515:function(t,e,a){},"429a":function(t,e,a){"use strict";a("2515")},acd7:function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"template-list"},[e("h3",{staticClass:"mb-4"},[t._v("脚本模板管理")]),e("div",{staticClass:"d-flex justify-content-between mb-3"},[e("b-form-input",{staticClass:"w-25 mr-2",attrs:{placeholder:"搜索模板名称"},on:{input:t.handleSearch},model:{value:t.searchKeyword,callback:function(e){t.searchKeyword=e},expression:"searchKeyword"}}),e("b-button",{attrs:{variant:"primary"},on:{click:t.showCreateModal}},[e("b-icon",{attrs:{icon:"plus"}}),t._v(" 新建模板 ")],1)],1),t.loading?e("div",{staticClass:"text-center py-5"},[e("b-spinner",{attrs:{variant:"primary",label:"加载中..."}}),e("p",{staticClass:"mt-2"},[t._v("加载模板数据...")])],1):t._e(),t.error?e("b-alert",{attrs:{show:"",variant:"danger",dismissible:""}},[t._v(" "+t._s(t.error)+" ")]):t._e(),t.loading||0!==t.templates.length?e("div",[e("b-card-group",{attrs:{columns:""}},t._l(t.templates,(function(a){return e("b-card",{key:a.id,staticClass:"mb-3 template-card",attrs:{"no-body":""}},[e("b-card-header",{staticClass:"d-flex justify-content-between align-items-center py-2"},[e("h5",{staticClass:"mb-0"},[t._v(t._s(a.name))]),e("div",[e("b-button",{staticClass:"mr-1",attrs:{variant:"outline-primary",size:"sm"},on:{click:function(e){return t.showEditModal(a)}}},[e("b-icon",{attrs:{icon:"pencil"}})],1),e("b-button",{attrs:{variant:"outline-danger",size:"sm"},on:{click:function(e){return t.confirmDelete(a.id)}}},[e("b-icon",{attrs:{icon:"trash"}})],1)],1)]),e("b-card-body",[e("div",{staticClass:"script-content"},[e("pre",[e("code",[t._v(t._s(a.content))])])]),e("div",{staticClass:"text-muted mt-2"},[e("small",[e("b-icon",{attrs:{icon:"clock-history"}}),t._v(" 创建时间: "+t._s(t.formatDate(a.created_time))+" ")],1),a.updated_time?e("small",{staticClass:"ml-2"},[e("b-icon",{attrs:{icon:"pencil"}}),t._v(" 更新时间: "+t._s(t.formatDate(a.updated_time))+" ")],1):t._e()])])],1)})),1)],1):e("b-alert",{attrs:{show:"",variant:"info"}},[t._v(' 暂无脚本模板。点击"新建模板"按钮创建第一个脚本模板。 ')]),e("b-modal",{attrs:{title:t.isEditing?"编辑模板":"创建模板",size:"lg","ok-title":"保存","cancel-title":"取消"},on:{hidden:t.resetForm,ok:t.handleSubmit},model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[e("b-form",[e("b-form-group",{attrs:{label:"模板名称","label-for":"template-name",state:t.nameState,"invalid-feedback":t.nameInvalidFeedback}},[e("b-form-input",{attrs:{id:"template-name",required:"",placeholder:"请输入模板名称",state:t.nameState},model:{value:t.form.name,callback:function(e){t.$set(t.form,"name",e)},expression:"form.name"}})],1),e("b-form-group",{attrs:{label:"脚本内容","label-for":"script-content",state:t.contentState,"invalid-feedback":t.contentInvalidFeedback}},[e("b-form-textarea",{staticClass:"code-textarea",attrs:{id:"script-content",rows:"12","no-resize":"",required:"",placeholder:"#!/bin/bash",state:t.contentState},model:{value:t.form.content,callback:function(e){t.$set(t.form,"content",e)},expression:"form.content"}})],1)],1)],1),e("b-modal",{attrs:{id:"delete-confirm-modal",title:"确认删除","ok-variant":"danger","ok-title":"删除","cancel-title":"取消"},on:{ok:t.handleDelete}},[e("p",[t._v("确定要删除该模板吗？此操作不可恢复。")])])],1)},n=[],i=a("2f62"),o=a("c1df"),l=a.n(o),r={name:"TemplateList",data(){return{searchKeyword:"",showModal:!1,isEditing:!1,validated:!1,deleteTemplateId:null,form:{id:null,name:"",content:""}}},computed:{...Object(i["d"])("templates",["loading","error"]),...Object(i["c"])("templates",["allTemplates"]),templates(){let t=this.allTemplates;if(this.searchKeyword){const e=this.searchKeyword.toLowerCase();t=t.filter(t=>t.name.toLowerCase().includes(e)||t.content.toLowerCase().includes(e))}return t},nameState(){return this.validated?this.form.name.trim().length>0:null},contentState(){return this.validated?this.form.content.trim().length>0:null},nameInvalidFeedback(){return"请输入模板名称"},contentInvalidFeedback(){return"请输入脚本内容"}},methods:{...Object(i["b"])("templates",["fetchTemplates","createTemplate","updateTemplate","deleteTemplate"]),formatDate(t){return t?l()(t).format("YYYY-MM-DD HH:mm:ss"):""},handleSearch(){},showCreateModal(){this.isEditing=!1,this.form={id:null,name:"",content:"#!/bin/bash\n\n"},this.showModal=!0},showEditModal(t){this.isEditing=!0,this.form={id:t.id,name:t.name,content:t.content},this.showModal=!0},resetForm(){this.form={id:null,name:"",content:""},this.validated=!1},confirmDelete(t){this.deleteTemplateId=t,this.$bvModal.show("delete-confirm-modal")},async handleSubmit(t){if(t.preventDefault(),this.validated=!0,this.nameState&&this.contentState)try{this.isEditing?(await this.updateTemplate({templateId:this.form.id,templateData:{name:this.form.name,content:this.form.content}}),this.$bvToast.toast("模板更新成功",{title:"成功",variant:"success",solid:!0})):(await this.createTemplate({name:this.form.name,content:this.form.content}),this.$bvToast.toast("模板创建成功",{title:"成功",variant:"success",solid:!0})),this.showModal=!1}catch(e){this.$bvToast.toast(e.message||"操作失败，请重试",{title:"错误",variant:"danger",solid:!0})}},async handleDelete(){if(this.deleteTemplateId)try{await this.deleteTemplate(this.deleteTemplateId),this.$bvToast.toast("模板删除成功",{title:"成功",variant:"success",solid:!0}),this.deleteTemplateId=null}catch(t){this.$bvToast.toast(t.message||"删除失败，请重试",{title:"错误",variant:"danger",solid:!0})}}},async created(){this.$root.$on("show-create-template-modal",this.showCreateModal);try{await this.fetchTemplates()}catch(t){console.error("获取模板列表失败:",t)}},beforeDestroy(){this.$root.$off("show-create-template-modal",this.showCreateModal)}},c=r,d=(a("429a"),a("2877")),m=Object(d["a"])(c,s,n,!1,null,"98fd8316",null);e["default"]=m.exports}}]);
//# sourceMappingURL=chunk-14b4a015.13189099.js.map